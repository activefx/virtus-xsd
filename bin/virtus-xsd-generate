#!/usr/bin/env ruby
unless (1..3).include?(ARGV.length)
  puts "Usage: $0 <path-to-xsd> [<output-dir> [<module-name>]]"
  exit(1)
end

xsd_path = File.expand_path(ARGV[0])
output_dir = File.expand_path(ARGV[1])
module_name = ARGV[2]

Dir.chdir(File.expand_path('..', __FILE__)) do
  require 'bundler'

  Bundler.setup

  require 'virtus/xsd'
  require 'nokogiri'

  type_definitions = Virtus::Xsd::XsdParser.parse(xsd_path)
  Virtus::Xsd::RubyGenerator.new(type_definitions,
                                 output_dir: output_dir, module_name: module_name).generate_classes
end